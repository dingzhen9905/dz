<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../../css/common/mui.css">
		<link rel="stylesheet" href="../../css/index.css">
		<link rel="stylesheet" href="../../css/fonts/iconfont.css" />
		<style>
			.mui-bar-nav~.mui-content .mui-pull-top-pocket {
				top: 100px;
			}
			.hide{display: none;}
			header a, header h1{color: #FFFFFF !important;}
			.mui-content{padding-top: 65px !important;}
			.vrac203-search-terms{position: fixed;z-index: 100000000;width:100%;height:75px;background: #EAEAEA;overflow: hidden;}
			label{font-size: 12px;color: #6C6C6C;}
			input{height:30px !important;margin:3px auto !important;padding:2px !important;border:1px solid #5da8fa !important;border-radius:10px !important;font-size: 14px;}
			input[placeholder] {padding:2px !important;font-size: 14px;color: #000;}
					
			.search-terms-txt{padding: 8px 5px;text-align:;color: #000000;}
			.search-terms-title{padding-left:10px}
			.hide {display: none;}
			.order-main-li{margin-bottom:5px;padding:5px 10px !important;background:#fff;border-top:0px solid #E0E0E0; box-shadow: 3px 3px 3px #ccc}
			.order-imgbox{padding:5px;padding-left:0px;box-sizing:border-box;}
			.order-info-title {padding-top:1px;font-size: 14px;color:#242424;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;}
			.order-info-leftbox{}
			.order-info-left {display: -webkit-box;min-height: 14px;margin-bottom:1px;font-size: 12px;line-height: 12px;-webkit-box-orient: vertical;-webkit-line-clamp: 2;overflow: hidden;}
			.order-info-rightbox{text-align: right;}
			.order-info-right {font-size: 12px;line-height: 14px;float: right;margin:1px auto;}
			.order-price{color:#FF5053;font-size: 14px;}
			.order-qty{font-size: 16px;color: #000000;}
			.order-statusbox{text-align:right;padding-right:10px;}
			.order-status {margin-left:10px;font-size: 10px;line-height: 14px;color: #f0ad4e;border: 1px solid #f0ad4e;border-radius: 2px;text-align: center;}
			.detail-label{padding:0px 5px 0px 50px !important;}
			.mui-row:before,
			.mui-row:after,
			.mui-table-view-cell:after,
			.mui-table-view-cell:before{height:0px;}
			.content-total{border-top:1px dashed #C0C0C0}
			.vl-list-search-tip{padding:100px;height:300px;text-align: center;}
			.vl-list-search-tip .icon {color:#353B42;font-size:100px;}
			.vl-list-search-result{color:#000 !important;margin-top:10px;margin-bottom:0;border-bottom: transparent;padding-bottom:0;}
			.vl-list-search-icon{color:#0062cc;height:100px;line-height: 100px;font-size: 100px;}
			.list_sts{padding:3px; font-size:12px;}
			/**/
			.vl-tab-bar{background: #F0F0F0;}
			.vl-tab-item{height: 32px;line-height: 30px;color: #242424;text-align: center;}
			/* .vl-tab-item:hover{background:#EA6D10;color: #FFFFFF;} */
			.vl-tab-item.active{color: #EA6D10;border-bottom: 2px solid #EA6D10;}
			.searchBar{
				height: 75px;
				padding-top: 20px;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav headerMain plistHeader" id="head" style="height: 175px;">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left" id="goBack"></a>
			<div class="mui-title plistTitle">
				<p id="TO">终端审核</p>
				<h1 id="header"></h1>
			</div>
			<div class="mui-row navBar topNavRow" id="topNav">
				<p class="mui-col-xs-6 topNav active" data-task="VR_vdvc312_query_08" data-type="001">待审核<span></span></p>
				<p class="mui-col-xs-6 topNav" data-task="VR_vdvc312_query_16" data-type="001">已审核<span></span></p>
			</div>
			<div class="mui-row searchBar" id="dcheck">
				<div class="mui-col-xs-10">
					<div class="mui-input-row mui-search">
						<input type="search" id="searchBox" class="mui-input-clear" onkeyup="enterSearch(event)" placeholder="">
					</div>
				</div>
				<div class="mui-col-xs-2">
					<button type="button" id="J_btn_search" class="mui-btn" >查询</button>
				</div> 
			</div>
			
			<div class="vrac203 vrac203-search vrac203-search-terms" id="__date" style="display: none;">
				<div class="mui-row vl-tab-bar" id="J_tabbar"></div>
				<div class="mui-row">
					<div class="search-terms-txt mui-col-xs-2">时间段:</div>
					<div class="search-terms-depts mui-col-xs-4">
							<input id="J_bdate" type="date" class="requiredInput search-date" placeholder="">
			   		</div>
			   		<div class="search-terms-txt mui-col-xs-1">至:</div>
			   		<div class="search-terms-clients mui-col-xs-4">
							<input id="J_edate" type="date" class="requiredInput search-date" placeholder="">
			   		</div>
			   		<div class="search-terms-txt mui-col-xs-1"></div>
				</div>
				<div class="mui-row">
			   		<div class="search-terms-clients mui-col-xs-9 mui-row">
						<div class="search-terms-txt mui-col-xs-2">搜索</div>
						<div class="search-terms-depts mui-col-xs-10">
								<input type="search" id="searchBoxdate" class="mui-input-clear" onkeyup="enterSearch(event)" placeholder="">
				   		</div>
					</div>
					<div class="mui-col-xs-2" id="J_btn_searchdate" style="padding-left:10px;box-sizing: border-box !important;">
						<button class="mui-btn-primary mui-btn-outlined">查询</button>
					</div>
					<div class="search-terms-txt mui-col-xs-1"></div>
				</div>
			</div>
		</header>
		<div class="mui-content">

		</div>

	</body>
	<script src="../../js/mui.min.js"></script>
	<script src="../../js/jquery-2.1.0.js"></script>
	<script src="../../js/md5.js"></script>
	<script src="../../js/vlindex.js" type="text/javascript" charset="utf-8"></script>
	<script src="../../js/immersed.js" type="text/javascript"></script>
	<script type="text/javascript">
		var teamBillCom = null;
		var teamBillComName = null;
		var userbillNo = null;
		var userName = null;
		var loginCom = null;
		var loginComName = null;
		var privilege = null;
		var fromPage = null;
		var fbill_no = null;
		var BreadcrumbNav = [];
		var BreadcrumbNavName = [];
		var ROOTfbillNo = "";
		var search = '';
		var oldBack = mui.back;
		mui.back = newBack;
		//启用双击监听
		mui.init({
			gestureConfig: {
				doubletap: true
			},
			subpages: [{
				url: 'vdvc312sh_list.html',
				id: 'vdvc312sh_list.html',
				styles: {
					top: '175px',
					bottom: '5px',
				}
			}]
		});

		var contentWebview = null;
		document.querySelector('header').addEventListener('doubletap', function() {
			if(contentWebview == null) {
				contentWebview = plus.webview.currentWebview().children()[0];
			}
			contentWebview.evalJS("mui('#vdvc312sh_list').pullRefresh().scrollTo(0,0,100)");
		});
        window.addEventListener("sizetoplistmath", function(e) { ecListSize(e) });
		// 进入页面插件加载完成拉去数据
		mui.plusReady(function() {
			//接收传过来的参数
			var self = plus.webview.currentWebview();
			// 基本参数(必要)
			teamBillCom = self.teamBillCom; 
			teamBillComName = self.teamBillComName; 
			fbill_no = self.fbill_no; 
			loginCom = self.loginCom; 
			loginComName = self.loginComName; 
			userbillNo = self.userbillNo; 
			userName = self.userName; 
			privileges = self.privileges; 
			fromPage = self.fromPage;
			// 其他
			ROOTfbillNo = self.fbill_no;

			BreadcrumbNav.push(teamBillCom); 
			BreadcrumbNavName.push(teamBillComName);
			
			// 更改header的显示信息
			document.getElementById("header").innerHTML = teamBillComName; //头部显示发货单位名
			document.getElementById("J_btn_search").addEventListener("tap",eBtnSarech, false);
			document.getElementById("J_btn_searchdate").addEventListener("tap",eBtnSarech, false);
			// nav
			mui("#topNav").on("tap", "p", function() { eaTopNav(this)});	
			document.getElementById('J_bdate').value = VlDate.get(new Date(), "_ymd");
			document.getElementById('J_edate').value = VlDate.get(new Date(), "_ymd");
		}); // plusReady
		
		function enterSearch(e) {e.keyCode == 13 && eBtnSarech();}
		
		function eBtnSarech() {
			document.getElementById("searchBox").blur();
	        search = document.getElementById("searchBox").value;
			document.getElementById("searchBoxdate").blur();
			search = document.getElementById("searchBoxdate").value
			var __diffent = jQuery("#topNav").children(".active").attr("data-task")
			if(__diffent=="VR_vdvc312_query_16"){
				var _date=getBEDate()
				bdate=_date.bdate
				ddate=_date.edate
			}else{
				var bdate=""
				var ddate=""
			}
				mui.fire(plus.webview.getWebviewById('vdvc312sh_list.html'), 'differentStatesRefresh210list', {
					activeType: jQuery("#topNav").children(".active").attr("data-type"),
					activeTask: jQuery("#topNav").children(".active").attr("data-task"),
					search: search,
					bill_bdate	 : bdate,
					bill_edate	 : ddate,
				});
				
			
		}
		function eaTopNav(self) {
			jQuery(self).addClass("active").siblings().removeClass("active");
			var _type = self.getAttribute("data-type");
			var _diffent = self.getAttribute("data-task")
			if(_diffent=="VR_vdvc312_query_16"){				
				document.getElementById("__date").style.display="block"
				document.getElementById("dcheck").style.display="none"
				var _date=getBEDate()
				bdate=_date.bdate
				ddate=_date.edate
			}else{
				document.getElementById("__date").style.display="none"
				document.getElementById("dcheck").style.display="block"	
				var bdate=""
				var ddate=""
			}
			
			//触发详情页面的newsId事件
			mui.fire(plus.webview.getWebviewById('vdvc312sh_list.html'), 'differentStatesRefresh210list', {
				activeType: _type,
				activeTask: self.getAttribute("data-task"),
				search: search,
				bill_bdate	 : bdate,
				bill_edate	 : ddate,
			});
		}
		function getBEDate() {
			var bdate = document.getElementById("J_bdate").value,
				edate = document.getElementById("J_edate").value;
			if(bdate == "" || edate == ""){
				mui.toast("请先选择时间段~")
				return false;
			}
			return {
				bdate : bdate + " 00:00:00",
				edate : edate + " 23:59:59",
			}
		}
		function ecListSize(e) {
			var txt = "("+e.detail.totalRecord+")";
			jQuery("#topNav").find('.active').children().html(txt)
		}
		function newBack() {
				// 重写
				if(BreadcrumbNav.length > 1) {

					BreadcrumbNav.splice(BreadcrumbNav.length - 1, 1);
					BreadcrumbNavName.splice(BreadcrumbNavName.length - 1, 1);

					teamBillCom = BreadcrumbNav[BreadcrumbNav.length - 1]; // 0109增加
					teamBillComName = BreadcrumbNavName[BreadcrumbNavName.length - 1]; // 0109增加

					fbill_no = BreadcrumbNav[BreadcrumbNav.length - 1]; // 0109增加
					if(fbill_no == loginCom) { // 0109增加
						fbill_no = "ROOT";
					}
					 
					document.getElementById("header").innerHTML = teamBillComName; // 0109之前为 fbillnoname
					jQuery(".topNav:first").addClass("active").siblings().removeClass("active");

					var childList = plus.webview.getWebviewById('vdvc312sh_list.html');
					mui.fire(plus.webview.getWebviewById('vdvc312sh_list.html'), "backAndRefreshList", {
						teamBillCom: teamBillCom, // 1.管理单位代码	// 每点一次就变为数组中的上一项
						teamBillComName: teamBillComName, // 2.管理单位名称	// 每点一次就变为数组中的上一项
						fbill_no: fbill_no, // 3.fbill_no是		// 每点一次就变为数组中的上一项
						loginCom: loginCom, // 4.登录单位代码
						loginComName: loginComName, // 5.登录单位名称
						userbillNo: userbillNo, // 6.登录人的代码
						userName: userName, // 7.登录人的姓名
						privileges: privileges, // 8.当前的权限是
						fromPage: "vdst316plist", // 9.从哪个页面来
						bill_bdate	 : "",
						bill_edate	 : "",
					})
					mui.openWindow({
						id: "vdvc312sh_list.html"

					})
				}
				if(BreadcrumbNav.length == 1) {
					oldBack();
					return;
				}

			}
	</script>

</html>